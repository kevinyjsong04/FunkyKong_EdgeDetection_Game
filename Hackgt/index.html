<!-- FILEPATH: /index.html -->

<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Webcam Input with p5.js</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.min.js"></script>
  </head>
  <body>
    <script>
      let img;

      let kernel = [
        [-1, 0, 1],
        [-2, 0, 2],
        [1, 0, 1]
      ];

      function setup() {
        createCanvas(100, 100);
        img = createCapture(VIDEO);
        img.hide();
      }

      function draw() {
      
        edgeImg = createImage(img.width, img.height);
        edgeImg.loadPixels();

        for (let x = 1; x < img.width - 1; x++) {
          for (let y = 1; y < img.height - 1; y++) {
            let sum = 0;

            for (kx = -1; kx <= 1; kx++) {
              for (ky = -1; ky <= 1; ky++) {
                let xpos = x + kx;
                let ypos = y + ky;
                let pos = (y + ky) * img.width + (x + kx);
                let val = red(img.get(xpos, ypos));
                sum += kernel[ky + 1][kx + 1] * val;
              }
            }

            // set the pixel value of the edgeImg
            edgeImg.set(x, y, color(sum, sum, sum));
          }
        }
        edgeImg.updatePixels();

        image(edgeImg, 0, 0);
      }

    </script>
  </body>
</html>
